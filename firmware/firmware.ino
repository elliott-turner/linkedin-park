#include "stepper.h"
#include "bsp.h"

void setup() {
  stepper_setup();
  Serial.begin(9600);
}

MOVE moves[] = {
  {1000, 10000, 2000},
  {3000, 400000, 40000},
  {1000, 50000, 5000},
  {3000, 400000, 40000},
  {1000, 50000, 5000},
  {3000, 400000, 40000},
  {1000, 50000, 5000},
  {3000, 400000, 40000},
  {3500, 10000, 10000},
  {3000, 400000, 10000},
  {3500, 10000, 10000},
  {3000, 400000, 10000},
  {3500, 10000, 10000},
  {3000, 400000, 10000},
  {3500, 10000, 10000},
  {3000, 400000, 10000},
  {3500, 10000, 10000},
  {100, 100000, 10000},
  {500, 10000, 100000},
  {100, 100000, 10000},
  {500, 10000, 100000},
  {100, 100000, 10000},
  {500, 10000, 100000},
  {100, 100000, 10000},
  {500, 10000, 100000},
  {100, 100000, 10000},
  {500, 10000, 100000},
  {2000, 100000, 100000},
  {0, 1000, 2000},
};
int num_moves = 29;
int move_index = 0;
bool test = true;

void loop() {
  stepper_tasks();
  if (stepper_move_complete() and test) {
    Serial.print("testing ");
    Serial.print(move_index);
    Serial.print("...\n");
    stepper_move(moves[move_index]);
    if (++move_index == num_moves) {
      move_index = 0;
      // test = false;
    }
  }
}
